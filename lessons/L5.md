# Lesson 5 - Objects and Inheritance

## Intro

So far, we've worked with basic types: numbers, strings, and arrays. But SIMPL also supports **custom objects** - user-defined types that can have their own data members and can inherit from each other. This is where SIMPL's object-oriented features shine!

Objects in SIMPL allow you to:
- **Define custom types** with named members
- **Create instances** of your types
- **Initialize members** with default values
- **Inherit from other objects** to create type hierarchies
- **Access and modify** object members using dot notation

Think of objects as blueprints for creating data structures that model your problem domain.

## Defining Objects

The basic syntax for defining an object in SIMPL is:

```simpl
object TypeName {
    member1;
    member2;
}
```

You can also initialize members with default values:

```simpl
object Card {
    suit = "hearts";
    rank = "ace";
}
```

## Creating Object Instances

To create an instance of an object, use the `new` keyword:

```simpl
let myCard = new Card{};
```

You can also override default values when creating an instance:

```simpl
let queenOfDiamonds = new Card{ suit="diamonds", rank="queen" };
```

## Accessing Object Members

Use dot notation to access or modify object members:

```simpl
println(myCard.suit);      # prints "hearts"
myCard.rank = "king";       # modify the rank
println(myCard.rank);       # prints "king"
```

## Inheritance

SIMPL supports single inheritance using the `inherits` keyword:

```simpl
object Vehicle {
    speed = 0;
    color = "black";
}

object Car inherits Vehicle {
    doors = 4;
}

object Motorcycle inherits Vehicle {
    doors = 0;
}
```

When an object inherits from another:
- It gets all the parent's members
- It can add its own members
- It can override parent member values

```simpl
let myCar = new Car{ color="red", speed=60 };
println(myCar.color);   # "red"
println(myCar.speed);   # 60
println(myCar.doors);   # 4
```

## Real-World Example: Space Objects

Here's a practical example modeling space objects:

```simpl
@import io

object SpaceObject {
    x = 0;
    y = 0;
    size = 100;
}

object Asteroid inherits SpaceObject {
    size = 50;
}

object Spaceship inherits SpaceObject {
    size = 75;
    fuel = 100;
}

# Create some objects
let ast1 = new Asteroid{ x=100, y=200 };
let ship1 = new Spaceship{ x=50, y=50, fuel=80 };

println("Asteroid at: " + ast1.x + ", " + ast1.y);
println("Spaceship fuel: " + ship1.fuel);
```

## Exercise 5 - Understanding Objects

Review how objects are defined and used in the existing codebase:

1. Look at `examples/object.sl` to see object examples
2. Look at `examples/example.sl` to see the space object example
3. Review the parser tests in `simpl.test/simpl.parser.test.cpp` for object-related tests

You'll find tests like:
- `TestParseSimplObjectEmpty` - Empty object definition
- `TestParseSimpleObjectWMembers` - Object with members
- `TestParseSimplObjectWInitializer` - Object with initialized members
- `TestParseSimpleObjectInherits` - Object with inheritance

## Your Contribution: Create an Object Hierarchy

Now it's your turn to create a meaningful object hierarchy and test it!

### Task: Build a Game Character System

Create a new file called `examples/characters.sl` that defines a character hierarchy for a simple game:

**Requirements:**
1. Create a base `Character` object with:
   - `name` (string)
   - `health` (number, default 100)
   - `level` (number, default 1)

2. Create at least two character types that inherit from `Character`:
   - `Warrior` - should have an `armor` member
   - `Mage` - should have a `mana` member

3. Create instances of each character type
4. Print out character information
5. Modify some member values and print again

**Example skeleton:**

```simpl
@import io

object Character {
    name = "Unknown";
    health = 100;
    level = 1;
}

object Warrior inherits Character {
    armor = 50;
}

# Add your Mage object here

# Create instances and test them
let warrior1 = new Warrior{ name="Conan", level=5 };
println("Warrior: " + warrior1.name);
println("Health: " + warrior1.health);
println("Armor: " + warrior1.armor);

# Add more code here
```

### Testing Your Code

1. Run your program using the REPL:
   ```
   simpl.repl.exe ..\examples\characters.sl
   ```

2. Verify that:
   - All objects are created successfully
   - Members have the correct values
   - Inheritance works (child objects have parent members)
   - You can modify member values

### Bonus Challenges

1. **Add more character types:**
   - `Rogue` with `stealth` member
   - `Priest` with `faith` member

2. **Create a deeper hierarchy:**
   - `MeleeWarrior` inherits from `Warrior`
   - `RangedWarrior` inherits from `Warrior`

3. **Add a test for your objects:**
   - In `simpl.test/simpl.parser.test.cpp` or `simpl.test/simpl.engine.test.cpp`
   - Test that your character objects can be parsed or evaluated correctly

### Commit Your Work

```bash
git add examples/characters.sl
git commit -m "Add character hierarchy example with objects and inheritance"
```

## Understanding Object Implementation

Behind the scenes, when you define an object:

1. **Parser** creates an `object_definition_statement` in the AST
2. **Engine** registers the object type in its type system
3. **Instance creation** allocates memory and initializes members
4. **Member access** uses a map/dictionary lookup by member name

Objects in SIMPL are dynamically typed - you can add new members at runtime, and member access is resolved during execution.

## Key Takeaways

✅ **Objects** let you define custom types with named members  
✅ **Inheritance** allows code reuse and type hierarchies  
✅ **Instance creation** uses `new TypeName{}`  
✅ **Member access** uses dot notation  
✅ **Initialization** can override default member values  
✅ **Dynamic nature** allows flexible object structures  

Great work! You now understand how to create and use custom objects in SIMPL. This is essential for the next lesson on multiple dispatch!

## Next
[Lesson 6](https://github.com/mvpete/simpl/blob/master/lessons/L6.md)
